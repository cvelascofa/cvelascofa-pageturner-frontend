<div class="mb-4">
  <h6 class="text-muted mb-3">Friends</h6>

  <div class="scroll-lg">
    <table class="table d-none d-md-table" *ngIf="acceptedLoaded; else loadingAccepted">
      <thead>
        <tr>
          <th scope="col">Username</th>
          <th scope="col">Email</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let friend of acceptedFriends">
          <td>
            <a [routerLink]="['/user', friend.senderId === currentUserId ? friend.recipientId : friend.senderId]"
              class="user-link">
              {{ friend.senderId === currentUserId ? friend.recipientUsername : friend.senderUsername }}
            </a>
          </td>
          <td>
            {{ friend.senderId === currentUserId ? friend.recipientEmail : friend.senderEmail }}
          </td>
          <td>
            <button class="btn btn-danger btn-sm" (click)="confirmRemove(friend)">
              Delete
            </button>
          </td>
        </tr>
        <tr *ngIf="acceptedFriends.length === 0">
          <td colspan="3" class="text-muted">No friends added yet.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="d-md-none">
    <div *ngIf="acceptedLoaded; else loadingAccepted">
      <div *ngFor="let friend of acceptedFriends" class="card mb-2">
        <div class="card-body p-3">
          <p class="mb-1">
            <strong>Username:</strong>
            <a [routerLink]="['/user', friend.senderId === currentUserId ? friend.recipientId : friend.senderId]"
              class="user-link">
              {{ friend.senderId === currentUserId ? friend.recipientUsername : friend.senderUsername }}
            </a>
          </p>
          <p class="mb-2">
            <strong>Email:</strong>
            {{ friend.senderId === currentUserId ? friend.recipientEmail : friend.senderEmail }}
          </p>
          <button class="btn btn-danger btn-sm" (click)="confirmRemove(friend)">Delete</button>
        </div>
      </div>
      <div *ngIf="acceptedFriends.length === 0" class="text-muted">
        No friends added yet.
      </div>
    </div>
  </div>

  <ng-template #loadingAccepted>
    <p>Loading accepted friends...</p>
  </ng-template>

  <div *ngIf="errorMessage" class="alert alert-danger mt-3">
    {{ errorMessage }}
  </div>
</div>

<app-modal #deleteModal [title]="deleteModal.title" [message]="deleteModal.message"
  [confirmButtonText]="deleteModal.confirmButtonText" [cancelButtonText]="deleteModal.cancelButtonText"
  [type]="deleteModal.type" (confirm)="onConfirmRemove()" (cancel)="onCancelRemove()">
</app-modal>