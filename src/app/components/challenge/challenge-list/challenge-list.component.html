<div class="container main-container mt-4">
    <h2 class="mb-4">
        {{ user?.username ? (user.username.endsWith('s') ? user.username + 'â€™ Challenges' : user.username + "'s Challenges") : 'User Challenges' }}
    </h2>

    <div class="mb-5" *ngFor="let categoryGroup of groupedCategories; let groupIndex = index">
        <h4 class="mb-2">{{ categoryGroup.category | titlecase }}</h4>

        <div class="row">
            <ng-container *ngFor="let challenge of categoryGroup.challenges; let i = index">
                <div class="col-md-4">
                    <div class="card h-100 border-0 rounded-4 text-center">
                        <div class="card-body d-flex flex-column align-items-center justify-content-center">
                            <img [src]="challenge.badgeUrl" alt="{{ challenge.name }} badge" width="100" height="100"
                                class="mb-3" />

                            <h5 class="mb-2">{{ challenge.name }}</h5>
                            <p class="mb-2 text-muted small">{{ challenge.description }}</p>

                            <div class="w-100 px-4">
                                <div class="progress" style="height: 20px;">
                                    <div class="progress-bar bg-info" role="progressbar"
                                        [style.width.%]="getChallengeProgress(challenge)"
                                        [attr.aria-valuenow]="getUserProgressValue(challenge)" aria-valuemin="0"
                                        [attr.aria-valuemax]="challenge.targetQuantity">
                                        {{ getUserProgressValue(challenge) }} / {{ challenge.targetQuantity }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card-footer text-center bg-light rounded-bottom-4">
                            <small class="text-muted">Keep pushing your limits!</small>
                        </div>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
</div>